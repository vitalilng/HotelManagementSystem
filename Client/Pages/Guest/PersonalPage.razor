@page "/personalpage"
@inject HttpClient httpClient
@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthenticationStateProvider

<h2>Personal Page</h2>

        <h1>Hello </h1>
        <p>@authMessage</p>
        @if(claims.Count() > 0)
        {
            <ul>
                @foreach(var claim in claims)
                {
                    <li>@claim.Type: @claim.Value</li>
                }
            </ul>
        }


@code{
    private string authMessage;
    private string surnameMessage;
    private IEnumerable<Claim> claims = Enumerable.Empty<Claim>();

    private async Task GetClaimsPrincipalData()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        if(user.Identity.IsAuthenticated)
        {
            authMessage = $"{user.Identity.Name} is authenticated";
            claims = user.Claims;
            surnameMessage = $"{user.FindFirst(c => c.Type == ClaimTypes.Surname)?.Value}";
        }
    }

}
